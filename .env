# =====================================================
# Tartware PMS - Environment Configuration
# Copy this file to .env and customize as needed
# =====================================================

# =====================================================
# AUTHENTICATION SETTINGS
# =====================================================

# JWT secret for signing tokens (min 32 characters)
AUTH_JWT_SECRET=development-jwt-secret-change-in-prod-32chars

# JWT verification settings for services that validate tokens
JWT_ISSUER=tartware-core-service
JWT_AUDIENCE=tartware-core
# JWT public key for token verification - generate your own for production
# Generate with: openssl genrsa -out private.pem 2048 && openssl rsa -in private.pem -pubout -out public.pem
JWT_PUBLIC_KEY=__REPLACE_WITH_YOUR_JWT_PUBLIC_KEY__

# Disable settings-service auth ONLY for local load tests (MUST remain false in prod)
# WARNING: Setting this to true bypasses authentication - NEVER use in production
DISABLE_AUTH=false

# Default password for seeded users (min 8 characters)
AUTH_DEFAULT_PASSWORD=TempPass123

# =====================================================
# DATABASE INITIALIZATION SETTINGS
# =====================================================

# Drop existing database on startup (⚠️ DELETES ALL DATA)
# Recommended: true for development, false for production
TARTWARE_DROP_EXISTING=true

# Run comprehensive verification after setup
# Recommended: true (ensures database quality)
TARTWARE_RUN_VERIFICATION=true

# Create backup before dropping database
# Recommended: false for dev, true for staging/prod
TARTWARE_BACKUP_BEFORE_DROP=false

# =====================================================
# POSTGRESQL SETTINGS
# =====================================================

# PostgreSQL superuser
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres

# Default database (do not change 'tartware')
POSTGRES_DB=tartware

# =====================================================
# SERVICE LOGGING FLAGS
# =====================================================

# Enable sanitized request/response logs for API gateway
API_GATEWAY_LOG_REQUESTS=false

# Enable sanitized request/response logs for reservations-command-service
RESERVATION_COMMAND_LOG_REQUESTS=false

# Settings service data source (seed | db)
SETTINGS_DATA_SOURCE=seed

# Service Endpoints
CORE_SERVICE_URL=http://localhost:3000
RESERVATION_COMMAND_SERVICE_URL=http://localhost:3101
GUESTS_SERVICE_URL=http://localhost:3300
ROOMS_SERVICE_URL=http://localhost:3400
HOUSEKEEPING_SERVICE_URL=http://localhost:3500
BILLING_SERVICE_URL=http://localhost:3600
COMMAND_CENTER_SERVICE_URL=http://localhost:3700
SETTINGS_SERVICE_URL=http://localhost:3000
COMMAND_CENTER_TOPIC=commands.primary
COMMAND_CENTER_CONSUMER_GROUP=reservations-command-center
COMMAND_CENTER_TARGET_SERVICE_ID=reservations-command-service
COMMAND_CENTER_OUTBOX_TENANT_THROTTLE_MS=25
COMMAND_CENTER_OUTBOX_TENANT_JITTER_MS=40
COMMAND_CENTER_OUTBOX_TENANT_THROTTLE_CLEANUP_MS=120000

# =====================================================
# RESERVATIONS COMMAND SERVICE
# =====================================================
# Kafka retry + dead-letter queue controls
RESERVATION_DLQ_TOPIC=reservations.events.dlq
KAFKA_MAX_RETRIES=3
KAFKA_RETRY_BACKOFF_MS=1000
KAFKA_RETRY_SCHEDULE_MS=1000,5000,30000
KAFKA_MAX_BATCH_BYTES=1048576

# Outbox dispatcher timing
OUTBOX_POLL_INTERVAL_MS=2000
OUTBOX_BATCH_SIZE=25
OUTBOX_LOCK_TIMEOUT_MS=30000
OUTBOX_MAX_RETRIES=5
OUTBOX_RETRY_BACKOFF_MS=5000
OUTBOX_TENANT_THROTTLE_MS=25
OUTBOX_TENANT_JITTER_MS=40
OUTBOX_TENANT_THROTTLE_CLEANUP_MS=120000

# Reliability snapshot thresholds
RELIABILITY_DLQ_WARN_THRESHOLD=10
RELIABILITY_DLQ_CRITICAL_THRESHOLD=50
RELIABILITY_STALLED_THRESHOLD_SECONDS=120
RELIABILITY_CONSUMER_STALE_SECONDS=60

# =====================================================
# DEVELOPMENT vs PRODUCTION
# =====================================================

# For DEVELOPMENT (current settings):
# TARTWARE_DROP_EXISTING=true   ← Database recreated each time
# TARTWARE_RUN_VERIFICATION=true
# TARTWARE_BACKUP_BEFORE_DROP=false

# For PRODUCTION (recommended):
# TARTWARE_DROP_EXISTING=false  ← NEVER drop in production
# TARTWARE_RUN_VERIFICATION=true
# TARTWARE_BACKUP_BEFORE_DROP=true

# =====================================================
# NOTES
# =====================================================

# 1. This file should NOT be committed with sensitive data
# 2. Copy to .env and customize: cp .env.example .env
# 3. Add .env to .gitignore
# 4. Use docker-compose.yml to load these variables
