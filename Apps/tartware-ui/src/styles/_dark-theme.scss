@use 'sass:color';
@use './variables' as vars;

/**
 * Centralized Dark Theme Styles
 * GitHub Soft Dark inspired theme
 * Reference: https://github.com/settings/appearance
 *
 * This file contains ALL dark theme overrides for the entire application.
 * DO NOT add dark theme styles in component files - keep them here for maintainability.
 */

$dark-surface: color.mix(vars.$gray-900, #000, 90%);
$dark-panel: color.mix(vars.$gray-900, #000, 75%);
$dark-panel-muted: color.mix(vars.$gray-800, #000, 65%);
$dark-border-strong: color.mix(vars.$gray-800, #000, 55%);
$dark-border-muted: color.mix(vars.$gray-700, #000, 45%);
$dark-text-primary: color.mix(#fff, vars.$gray-100, 80%);
$dark-text-secondary: color.mix(#fff, vars.$gray-200, 65%);
$dark-text-muted: color.mix(#fff, vars.$gray-300, 55%);
$dark-link: color.mix(vars.$info-600, vars.$primary-500, 60%);
$dark-link-hover: color.mix(vars.$info-600, vars.$primary-600, 55%);
$dark-success: color.mix(vars.$success-600, #fff, 12%);
$dark-warning: color.mix(vars.$warning-600, #fff, 20%);
$dark-purple: color.mix(vars.$badge-purple-text, #fff, 12%);
$dark-danger: color.mix(vars.$error-600, #fff, 12%);
$dark-info: color.mix(vars.$info-600, #fff, 6%);
$dark-border-accent: color.mix($dark-border-strong, #fff, 20%);
$dark-chip-surface: color.mix($dark-panel, #fff, 8%);
$dark-chip-surface-alt: color.mix($dark-panel, #fff, 12%);
$dark-text-inverse: color.mix(#fff, vars.$gray-50, 90%);

// Apply dark theme when body has dark-theme class
body.dark-theme,
body.dark-theme ~ *,
html:has(body.dark-theme) {
  background-color: $dark-surface !important;
  color: $dark-text-primary !important;
}

.dark-theme {
  // Self background
  background-color: $dark-surface !important;
  color: $dark-text-primary !important;

  // ============================================================================
  // GLOBAL UTILITY CLASS OVERRIDES (Tailwind)
  // ============================================================================

  // Backgrounds
  .bg-white {
    background-color: $dark-panel !important;
  }

  .bg-gray-50 {
    background-color: $dark-surface !important;
  }

  .bg-gray-100 {
    background-color: $dark-panel-muted !important;
  }

  .min-h-screen {
    background-color: $dark-surface;
  }

  // Borders
  .border-gray-200 {
    border-color: $dark-border-strong !important;
  }

  .page-header {
    .title {
      color: $dark-text-primary !important;
    }

    .subtitle {
      color: $dark-text-secondary !important;
    }

    mat-icon {
      color: $dark-text-primary !important;
    }

    button {
      border-color: $dark-border-strong !important;
      color: $dark-text-primary !important;

      mat-icon {
        color: currentColor !important;
      }
    }
  }

  .stats-card mat-icon,
  .table-card mat-icon {
    color: $dark-text-primary !important;
  }

  // Text colors
  .text-gray-900 {
    color: $dark-text-primary !important;
  }

  .text-gray-700 {
    color: $dark-text-primary !important;
  }

  .text-gray-600 {
    color: $dark-text-secondary !important;
  }

  .text-gray-500 {
    color: $dark-text-secondary !important;
  }

  .text-gray-400 {
    color: $dark-text-muted !important;
  }

  // Primary colors
  .bg-indigo-600 {
    background-color: $dark-link !important;

    &:hover {
      background-color: $dark-link-hover !important;
    }
  }

  .text-indigo-700 {
    color: $dark-link !important;
  }

  // Status badges - Success (Green)
  .bg-green-50 {
    background-color: rgba(63, 185, 80, 0.1) !important;
  }

  .text-green-700 {
    color: $dark-success !important;
  }

  .border-green-200 {
    border-color: rgba(63, 185, 80, 0.3) !important;
  }

  .bg-green-500 {
    background-color: $dark-success !important;
  }

  // Status badges - Info (Blue)
  .bg-blue-50 {
    background-color: rgba(88, 166, 255, 0.1) !important;
  }

  .text-blue-700 {
    color: $dark-link !important;
  }

  .border-blue-200 {
    border-color: rgba(88, 166, 255, 0.3) !important;
  }

  .bg-blue-500 {
    background-color: $dark-link !important;
  }

  // Status badges - Error (Red)
  .bg-red-50 {
    background-color: rgba(248, 81, 73, 0.1) !important;
  }

  .text-red-600,
  .text-red-700,
  .text-red-900 {
    color: $dark-danger !important;
  }

  .border-red-200 {
    border-color: rgba(248, 81, 73, 0.3) !important;
  }

  .bg-red-100 {
    background-color: rgba(248, 81, 73, 0.15) !important;
  }

  .bg-red-500 {
    background-color: $dark-danger !important;
  }

  // Status badges - Warning (Yellow)
  .bg-yellow-50 {
    background-color: rgba(210, 153, 34, 0.1) !important;
  }

  .text-yellow-700 {
    color: $dark-warning !important;
  }

  .border-yellow-200 {
    border-color: rgba(210, 153, 34, 0.3) !important;
  }

  // Status badges - Purple
  .bg-purple-50 {
    background-color: rgba(163, 113, 247, 0.1) !important;
  }

  .text-purple-700 {
    color: $dark-purple !important;
  }

  .border-purple-200 {
    border-color: rgba(163, 113, 247, 0.3) !important;
  }

  // Status badges - Indigo
  .bg-indigo-50 {
    background-color: rgba(88, 166, 255, 0.1) !important;
  }

  .border-indigo-200 {
    border-color: rgba(88, 166, 255, 0.3) !important;
  }

  // ============================================================================
  // SEMANTIC HTML ELEMENTS
  // ============================================================================

  body {
    background: $dark-surface;
    color: $dark-text-primary;
  }

  // Headers
  header {
    background-color: $dark-panel;
    border-bottom-color: $dark-border-strong;
  }

  // Links
  a {
    color: $dark-link;

    &:hover {
      color: $dark-link-hover;
    }
  }

  // Headings
  h1, h2, h3, h4, h5, h6 {
    color: $dark-text-primary;
  }

  // Paragraphs
  p {
    color: $dark-text-secondary;
  }

  // Code blocks
  code {
    background: $dark-panel-muted;
    color: $dark-link;
  }

  pre {
    background: $dark-panel;
    color: $dark-text-primary;
    border: 1px solid $dark-border-strong;
  }

  // ============================================================================
  // SCROLLBAR (WebKit browsers)
  // ============================================================================

  ::-webkit-scrollbar-track {
    background: $dark-surface;
  }

  ::-webkit-scrollbar-thumb {
    background: $dark-border-strong;

    &:hover {
      background: $dark-text-muted;
    }
  }

  // ============================================================================
  // SELECTION
  // ============================================================================

  ::selection {
    background: rgba(88, 166, 255, 0.2);
    color: $dark-text-primary;
  }

  // ============================================================================
  // FOCUS INDICATORS
  // ============================================================================

  *:focus-visible {
    outline-color: $dark-link;
  }

  // ============================================================================
  // MATERIAL TABLE COMPONENTS
  // ============================================================================

  ::ng-deep {
    // Table hover effects
    .mat-mdc-row:hover {
      background-color: $dark-panel-muted !important;
    }

    // Table headers
    .mat-mdc-header-cell {
      background-color: $dark-surface !important;
      color: $dark-text-primary !important;
      border-bottom-color: $dark-border-strong !important;
    }

    // Table cells
    .mat-mdc-cell {
      color: $dark-text-primary !important;
      border-bottom-color: $dark-panel-muted !important;
    }

    // Paginator
    .mat-mdc-paginator {
      background-color: $dark-panel !important;
      color: $dark-text-secondary !important;

      .mat-mdc-paginator-range-label {
        color: $dark-text-secondary !important;
      }
    }
  }

  // ============================================================================
  // STATUS BAR (Footer)
  // ============================================================================

  .status-bar {
    background-color: $dark-panel !important;
    border-top-color: $dark-border-strong !important;
    color: $dark-text-secondary !important;
    box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.5) !important;
  }

  .status-item {
    color: $dark-text-secondary !important;

    mat-icon {
      color: $dark-text-secondary !important;
    }

    span {
      color: $dark-text-secondary !important;
    }

    &.clickable:hover {
      background-color: $dark-panel-muted !important;
    }

    &.clickable:focus {
      outline-color: $dark-link !important;
    }

    // Environment indicators
    &.dev {
      color: $dark-link !important;

      mat-icon {
        color: $dark-link !important;
      }

      span {
        color: $dark-link !important;
      }
    }

    &.prod {
      color: $dark-success !important;

      mat-icon {
        color: $dark-success !important;
      }

      span {
        color: $dark-success !important;
      }
    }

    // Connection status
    &.online mat-icon {
      color: $dark-success !important;
    }

    &.offline mat-icon {
      color: $dark-danger !important;
    }
  }

  // ============================================================================
  // LOGIN PAGE
  // ============================================================================

  .login-container {
    background: $dark-surface;
  }

  .login-card {
    background: $dark-panel;
    border-color: $dark-border-strong;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  }

  .logo-section {
    .logo-circle {
      background: $dark-link;
    }

    h1 {
      color: $dark-text-primary;
    }

    p {
      color: $dark-text-secondary;
    }
  }

  .login-form {
    h2 {
      color: $dark-text-primary;
    }

    .form-group {
      label {
        color: $dark-text-primary;
      }

      input {
        background: $dark-surface;
        border-color: $dark-border-strong;
        color: $dark-text-primary;

        &:focus {
          border-color: $dark-link;
          box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
        }

        &::placeholder {
          color: $dark-text-muted;
        }

        &:disabled {
          background: $dark-panel-muted;
        }

        &.input-error {
          border-color: $dark-danger;

          &:focus {
            border-color: $dark-danger;
            box-shadow: 0 0 0 3px rgba(248, 81, 73, 0.15);
          }
        }
      }

      .field-error {
        color: $dark-danger;
      }
    }

    .error-message {
      background: rgba(248, 81, 73, 0.1);
      border-color: rgba(248, 81, 73, 0.3);
      border-left-color: $dark-danger;

      mat-icon {
        color: $dark-danger;
      }

      span {
        color: $dark-danger;
      }
    }

    .login-btn {
      background: $dark-link;

      &:hover:not(:disabled) {
        background: $dark-link-hover;
        box-shadow: 0 4px 6px rgba(88, 166, 255, 0.3);
      }
    }
  }

  .footer {
    border-top-color: $dark-border-strong;

    p {
      color: $dark-text-secondary;
    }
  }

  // ============================================================================
  // TENANT LIST PAGE
  // ============================================================================

  // User info card
  .bg-white.rounded-lg {
    background-color: $dark-panel !important;
    border-color: $dark-border-strong !important;
  }

  // Loading state
  .animate-spin {
    color: $dark-text-secondary;
  }

  // Table container and cells
  table {
    background-color: $dark-panel;
  }

  .mat-mdc-table {
    background-color: $dark-panel !important;
  }

  // Table header cells with !bg-gray-50 class
  th.mat-mdc-header-cell {
    background-color: $dark-surface !important;
    color: $dark-text-primary !important;
    border-bottom-color: $dark-border-strong !important;
  }

  // Table rows
  tr.mat-mdc-row {
    background-color: $dark-panel !important;
    border-bottom-color: $dark-panel-muted !important;

    &:hover {
      background-color: $dark-panel-muted !important;
    }
  }

  // Table data cells
  td.mat-mdc-cell {
    color: $dark-text-primary !important;
    border-bottom-color: $dark-panel-muted !important;
  }

  // Avatar circles and icon containers
  .bg-gray-100 {
    background-color: $dark-panel-muted !important;

    mat-icon, span {
      color: $dark-text-secondary !important;
    }
  }

  // Status indicators (gray state)
  .bg-gray-50 {
    background-color: rgba(139, 148, 158, 0.1) !important;
  }

  .text-gray-700 {
    color: $dark-text-primary !important;
  }

  .border-gray-200 {
    border-color: rgba(139, 148, 158, 0.3) !important;
  }

  .bg-gray-500 {
    background-color: $dark-text-secondary !important;
  }

  // Card shadows - reduce brightness in dark theme
  .shadow-sm {
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
  }

  // Buttons and interactive elements
  button mat-icon {
    color: inherit;
  }

  .hover\:bg-gray-50:hover {
    background-color: $dark-panel-muted !important;
  }

  // Refresh button in header
  .bg-indigo-600 {
    background-color: $dark-link !important;

    &:hover {
      background-color: $dark-link-hover !important;
    }
  }

  // Paginator
  .mat-mdc-paginator {
    background-color: $dark-panel !important;
    color: $dark-text-secondary !important;
    border-top-color: $dark-border-strong !important;

    .mat-mdc-icon-button {
      color: $dark-text-secondary !important;

      &:disabled {
        color: $dark-text-muted !important;
      }
    }

    .mat-mdc-select {
      color: $dark-text-primary !important;
    }

    .mat-mdc-paginator-page-size-label,
    .mat-mdc-paginator-range-label {
      color: $dark-text-secondary !important;
    }
  }

  // Material dropdown overlays (for paginator select)
  .mat-mdc-select-panel {
    background-color: $dark-panel !important;

    .mat-mdc-option {
      color: $dark-text-primary !important;

      &:hover {
        background-color: $dark-panel-muted !important;
      }

      &.mat-mdc-option-active {
        background-color: rgba(88, 166, 255, 0.1) !important;
      }
    }
  }

  // ============================================================================
  // MATERIAL COMPONENTS (Global)
  // ============================================================================

  // Tooltips
  .mat-mdc-tooltip {
    background-color: $dark-panel-muted !important;
    color: $dark-text-primary !important;
  }

  // Dialogs and overlays
  .cdk-overlay-pane {
    .mat-mdc-dialog-container {
      background-color: $dark-panel !important;
      color: $dark-text-primary !important;
    }
  }

  // Snackbar
  .mat-mdc-snack-bar-container {
    background-color: $dark-panel-muted !important;
    color: $dark-text-primary !important;
  }

  // Menu
  .mat-mdc-menu-panel {
    background-color: $dark-panel !important;

    .mat-mdc-menu-item {
      color: $dark-text-primary !important;

      &:hover {
        background-color: $dark-panel-muted !important;
      }
    }
  }

  // ============================================================================
  // PMS LAYOUT (Sidebar Navigation)
  // ============================================================================

  .pms-container {
    background-color: $dark-surface !important;
  }

  .pms-sidebar {
    background-color: $dark-panel !important;
    border-right-color: $dark-border-strong !important;

    .sidebar-header {
      border-bottom-color: $dark-border-strong !important;

      .logo-section {
        .logo-text {
          h3 {
            color: $dark-text-primary !important;
          }

          p {
            color: $dark-text-secondary !important;
          }
        }
      }
    }

    .nav-list {
      .nav-item {
        &:hover {
          background-color: $dark-panel-muted !important;
        }

        &.active {
          background-color: rgba(88, 166, 255, 0.15) !important;
          color: $dark-link !important;

          mat-icon {
            color: $dark-link !important;
          }
        }

        mat-icon {
          color: $dark-text-secondary !important;
        }

        span {
          color: $dark-text-primary !important;
        }
      }
    }

    .sidebar-footer {
      border-top-color: $dark-border-strong !important;

      .switch-tenant-btn {
        border-color: $dark-border-strong !important;
        color: $dark-text-primary !important;

        &:hover {
          background-color: $dark-panel-muted !important;
        }
      }
    }
  }

  .pms-content {
    background-color: $dark-surface !important;
  }

  .top-bar {
    background-color: $dark-panel !important;
    border-bottom-color: $dark-border-strong !important;

    .breadcrumb {
      mat-icon {
        color: $dark-text-secondary !important;
      }

      .tenant-name {
        color: $dark-text-primary !important;
      }
    }

    .property-selector {
      mat-icon {
        color: $dark-text-secondary !important;
      }

      .property-select {
        color: $dark-text-primary !important;
      }
    }
    .top-bar-right {
      .logout-btn {
        border-color: $dark-border-strong !important;
        color: $dark-text-primary !important;

      &:hover {
          border-color: $dark-border-accent !important;
          background-color: rgba(79, 70, 229, 0.15) !important;
      }
    }
  }

  // ============================================================================
  // Material components & shared surfaces
  // ============================================================================

  .mat-mdc-card,
  .settings-card,
  .filter-card,
  .search-card,
  .stats-card {
    background-color: $dark-panel !important;
    border: 1px solid $dark-border-strong !important;
    color: $dark-text-primary !important;

    mat-card-title,
    mat-card-subtitle {
      color: $dark-text-inverse !important;
    }
  }

  .mat-mdc-button,
  .mat-mdc-raised-button,
  .mat-mdc-stroked-button,
  .mat-mdc-unelevated-button,
  .mat-mdc-outlined-button {
    color: $dark-text-primary !important;
  }

  .mat-mdc-stroked-button,
  .mat-mdc-outlined-button {
    border-color: $dark-border-strong !important;
  }

  .mat-mdc-table,
  .mat-mdc-table .mdc-data-table__content {
    background-color: $dark-panel !important;
    color: $dark-text-primary !important;
  }

  .mat-mdc-table .mdc-data-table__header-row {
    background-color: $dark-chip-surface !important;
    color: $dark-text-inverse !important;
  }

  .mat-mdc-table .mdc-data-table__row {
    background-color: $dark-panel !important;
    border-bottom: 1px solid $dark-border-strong !important;

    &:hover {
      background-color: $dark-chip-surface-alt !important;
    }
  }

  .mat-mdc-form-field-flex {
    background-color: $dark-panel !important;
    border: 1px solid $dark-border-strong !important;
    border-radius: 8px !important;
  }

  .mat-mdc-text-field-wrapper {
    background-color: transparent !important;
  }

  .mat-mdc-form-field-infix,
  .mat-mdc-input-element,
  .mat-mdc-select-value,
  .mat-mdc-select-placeholder {
    color: $dark-text-inverse !important;
  }

  .settings-card {
    box-shadow: none !important;

    mat-card-title {
      color: $dark-text-inverse !important;
    }

    mat-card-subtitle {
      color: $dark-text-secondary !important;
    }
  }

  .settings-list {
    dt {
      color: $dark-text-inverse !important;
    }

    dd {
      color: $dark-text-secondary !important;
    }
  }

  .module-chip {
    background-color: rgba(88, 166, 255, 0.15) !important;
    color: $dark-link !important;
    border: 1px solid rgba(88, 166, 255, 0.25) !important;
  }
}

body.dark-theme .cdk-overlay-container .mat-mdc-select-panel {
  background-color: $dark-panel !important;
  color: $dark-text-primary !important;
  border: 1px solid $dark-border-strong !important;
}

  .user-menu-header {
    mat-icon {
      color: $dark-text-secondary !important;
    }

    .user-name {
      color: $dark-text-primary !important;
    }

    .user-email {
      color: $dark-text-secondary !important;
    }
  }

  // ============================================================================
  // DASHBOARD
  // ============================================================================

  .dashboard-container {
    .title {
      color: $dark-text-primary !important;
    }

    .subtitle {
      color: $dark-text-secondary !important;
    }
  }

  .stat-card {
    background-color: $dark-panel !important;
    border-color: $dark-border-strong !important;

    .stat-label {
      color: $dark-text-secondary !important;
    }

    .stat-value {
      color: $dark-text-primary !important;
    }
  }

  .section-title {
    color: $dark-text-primary !important;
  }

  .action-card {
    background-color: $dark-panel !important;
    border-color: $dark-border-strong !important;

    .action-button {
      background-color: $dark-panel !important;
      color: $dark-text-primary !important;

      &:hover {
        background-color: $dark-panel-muted !important;
      }

      mat-icon {
        color: $dark-link !important;
      }
    }
  }

  .activity-card,
  .tasks-card {
    background-color: $dark-panel !important;
    border-color: $dark-border-strong !important;

    mat-card-title {
      color: $dark-text-primary !important;

      mat-icon {
        color: $dark-text-secondary !important;
      }
    }
  }

  .activity-item,
  .task-item {
    background-color: $dark-surface !important;

    &:hover {
      background-color: $dark-panel-muted !important;
    }

    .activity-title,
    .task-title {
      color: $dark-text-primary !important;
    }

    .activity-meta,
    .task-meta {
      color: $dark-text-secondary !important;
    }
  }

  .activity-icon,
  .task-icon {
    background-color: $dark-panel !important;

    mat-icon {
      color: $dark-text-secondary !important;
    }

    &.urgent {
      background-color: rgba(248, 81, 73, 0.1) !important;

      mat-icon {
        color: $dark-danger !important;
      }
    }
  }

  // Empty state
  .empty-state {
    color: $dark-text-muted !important;

    mat-icon {
      color: $dark-text-muted !important;
    }

    p {
      color: $dark-text-secondary !important;
    }
  }

  // Error state
  .error-state {
    mat-icon {
      color: $dark-danger !important;
    }

    p {
      color: $dark-text-secondary !important;
    }
  }

  // Skeleton loading
  .skeleton {
    background: linear-gradient(
      90deg,
      $dark-panel 0%,
      $dark-panel-muted 50%,
      $dark-panel 100%
    ) !important;
    background-size: 200% 100%;
  }

  .skeleton-card {
    background-color: $dark-panel !important;
    border-color: $dark-border-strong !important;
  }

  // ============================================================================
  // RESERVATIONS
  // ============================================================================

  .reservations-container {
    .title {
      color: $dark-text-primary !important;
    }

    .subtitle {
      color: $dark-text-secondary !important;
    }

    .primary-button {
      background-color: $dark-link !important;

      &:hover {
        background-color: $dark-link-hover !important;
      }
    }
  }

  .filters-card,
  .table-card {
    background-color: $dark-panel !important;
    border-color: $dark-border-strong !important;
  }

  .loading-state {
    .loading-icon {
      color: $dark-link !important;
    }

    p {
      color: $dark-text-secondary !important;
    }
  }

  .reservations-table {
    background-color: $dark-panel !important;

    th {
      background-color: $dark-surface !important;
      color: $dark-text-primary !important;
    }

    td {
      color: $dark-text-primary !important;
      border-bottom-color: $dark-panel-muted !important;
    }

    .table-row {
      &:hover {
        background-color: $dark-panel-muted !important;
      }
    }

    .confirmation-code {
      color: $dark-link !important;
    }

    .guest-avatar {
      background-color: $dark-surface !important;

      mat-icon {
        color: $dark-text-secondary !important;
      }
    }

    .guest-name {
      color: $dark-text-primary !important;
    }

    .guest-email {
      color: $dark-text-secondary !important;
    }

    .room-number {
      color: $dark-text-primary !important;
    }

    .room-type {
      color: $dark-text-secondary !important;
    }

    mat-chip {
      &.status-confirmed {
        background-color: rgba(88, 166, 255, 0.15) !important;
        color: $dark-link !important;
      }

      &.status-checked-in {
        background-color: rgba(63, 185, 80, 0.15) !important;
        color: $dark-success !important;
      }

      &.status-checked-out {
        background-color: $dark-panel-muted !important;
        color: $dark-text-secondary !important;
      }

      &.status-cancelled {
        background-color: rgba(248, 81, 73, 0.15) !important;
        color: $dark-danger !important;
      }

      &.status-no-show {
        background-color: rgba(210, 153, 34, 0.15) !important;
        color: $dark-warning !important;
      }
    }

    .total-amount {
      color: $dark-text-primary !important;
    }

    .cancel-btn mat-icon {
      color: $dark-danger !important;
    }
  }

  .mat-mdc-paginator {
    background-color: $dark-surface !important;
    border-top-color: $dark-border-strong !important;
  }
}
