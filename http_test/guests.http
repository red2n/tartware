###############################################################################
# GUESTS SERVICE - Guest Profiles & Management
# Routes via API Gateway (localhost:8080) -> guests-service (port 3300)
#
# Content: Guest Profile Queries (READ OPERATIONS)
#
# WRITE OPERATIONS: All guest write operations go through the
# Command Center. See command-center.http for:
#   - guest.register
#   - guest.merge
#   - guest.update_profile
#   - guest.update_contact
#   - guest.set_loyalty
#   - guest.set_vip
#   - guest.set_blacklist
#   - guest.gdpr.erase
#   - guest.preference.update
#
# Related files:
# - command-center.http - Write operations (commands)
# - reservations.http - Guest reservations
# - billing.http - Guest billing
###############################################################################

# --- VARIABLES ---
@baseUrl = http://localhost:8080
@tenantId = 11111111-1111-1111-1111-111111111111
@propertyId = 22222222-2222-2222-2222-222222222222

###############################################################################
# 1. LOGIN
###############################################################################

# @name login
POST {{baseUrl}}/v1/auth/login
Content-Type: application/json

{
  "username": "setup.admin",
  "password": "TempPass123"
}

### Extract token
@authToken = {{login.response.body.access_token}}

###############################################################################
# 2. GUESTS - LIST WITH FILTERS
###############################################################################

# List all guests for tenant
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&limit=50
Authorization: Bearer {{authToken}}

###
# List guests for specific property
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&property_id={{propertyId}}&limit=50
Authorization: Bearer {{authToken}}

###
# Filter by email (partial match)
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&email=john
Authorization: Bearer {{authToken}}

###
# Filter by phone
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&phone=555-0101
Authorization: Bearer {{authToken}}

###
# Filter by VIP status
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&vip_status=true
Authorization: Bearer {{authToken}}

###
# Filter by loyalty tier
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&loyalty_tier=GOLD
Authorization: Bearer {{authToken}}

###
# Filter blacklisted guests
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&is_blacklisted=true
Authorization: Bearer {{authToken}}

###
# Combine multiple filters - VIP guests with PLATINUM loyalty
GET {{baseUrl}}/v1/guests?tenant_id={{tenantId}}&vip_status=true&loyalty_tier=PLATINUM
Authorization: Bearer {{authToken}}

###############################################################################
# 3. GUEST PREFERENCES - LIST BY GUEST
###############################################################################

@guestId = 33333333-3333-3333-3333-333333333333

###
# List all preferences for a guest
GET {{baseUrl}}/v1/guests/{{guestId}}/preferences?tenant_id={{tenantId}}
Authorization: Bearer {{authToken}}

###
# Filter by category - ROOM preferences
GET {{baseUrl}}/v1/guests/{{guestId}}/preferences?tenant_id={{tenantId}}&category=room
Authorization: Bearer {{authToken}}

###
# Filter by category - SERVICE preferences
GET {{baseUrl}}/v1/guests/{{guestId}}/preferences?tenant_id={{tenantId}}&category=service
Authorization: Bearer {{authToken}}

###
# Filter by category - DIETARY preferences
GET {{baseUrl}}/v1/guests/{{guestId}}/preferences?tenant_id={{tenantId}}&category=dietary
Authorization: Bearer {{authToken}}

###
# Filter by category - ACCESSIBILITY preferences
GET {{baseUrl}}/v1/guests/{{guestId}}/preferences?tenant_id={{tenantId}}&category=accessibility
Authorization: Bearer {{authToken}}

###
# Filter by category - COMMUNICATION preferences
GET {{baseUrl}}/v1/guests/{{guestId}}/preferences?tenant_id={{tenantId}}&category=communication
Authorization: Bearer {{authToken}}

###
# Active preferences only
GET {{baseUrl}}/v1/guests/{{guestId}}/preferences?tenant_id={{tenantId}}&active_only=true
Authorization: Bearer {{authToken}}

###############################################################################
# 4. GUEST DOCUMENTS - LIST BY GUEST
###############################################################################

###
# List all documents for a guest
GET {{baseUrl}}/v1/guests/{{guestId}}/documents?tenant_id={{tenantId}}
Authorization: Bearer {{authToken}}

###
# Filter by document type - PASSPORT
GET {{baseUrl}}/v1/guests/{{guestId}}/documents?tenant_id={{tenantId}}&document_type=passport
Authorization: Bearer {{authToken}}

###
# Filter by document type - NATIONAL_ID
GET {{baseUrl}}/v1/guests/{{guestId}}/documents?tenant_id={{tenantId}}&document_type=national_id
Authorization: Bearer {{authToken}}

###
# Filter by document type - DRIVERS_LICENSE
GET {{baseUrl}}/v1/guests/{{guestId}}/documents?tenant_id={{tenantId}}&document_type=drivers_license
Authorization: Bearer {{authToken}}

###
# Filter by verification status - VERIFIED
GET {{baseUrl}}/v1/guests/{{guestId}}/documents?tenant_id={{tenantId}}&verification_status=verified
Authorization: Bearer {{authToken}}

###
# Filter by verification status - PENDING
GET {{baseUrl}}/v1/guests/{{guestId}}/documents?tenant_id={{tenantId}}&verification_status=pending
Authorization: Bearer {{authToken}}

###
# Filter by verification status - EXPIRED
GET {{baseUrl}}/v1/guests/{{guestId}}/documents?tenant_id={{tenantId}}&verification_status=expired
Authorization: Bearer {{authToken}}

###############################################################################
# 5. GUEST COMMUNICATIONS - LIST BY GUEST
###############################################################################

###
# List all communications for a guest
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}
Authorization: Bearer {{authToken}}

###
# Filter by communication type - EMAIL
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&communication_type=email
Authorization: Bearer {{authToken}}

###
# Filter by communication type - SMS
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&communication_type=sms
Authorization: Bearer {{authToken}}

###
# Filter by communication type - PHONE
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&communication_type=phone
Authorization: Bearer {{authToken}}

###
# Filter by direction - OUTBOUND (sent to guest)
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&direction=outbound
Authorization: Bearer {{authToken}}

###
# Filter by direction - INBOUND (from guest)
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&direction=inbound
Authorization: Bearer {{authToken}}

###
# Filter by status - DELIVERED
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&status=delivered
Authorization: Bearer {{authToken}}

###
# Filter by status - OPENED
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&status=opened
Authorization: Bearer {{authToken}}

###
# Filter by status - FAILED
GET {{baseUrl}}/v1/guests/{{guestId}}/communications?tenant_id={{tenantId}}&status=failed
Authorization: Bearer {{authToken}}

###############################################################################
# REFERENCE
###############################################################################
#
# ID TYPES:
#   PASSPORT, DRIVERS_LICENSE, NATIONAL_ID, VISA, OTHER
#
# VIP LEVELS:
#   STANDARD, SILVER, GOLD, PLATINUM, DIAMOND
#
# LOYALTY TIERS:
#   BRONZE, SILVER, GOLD, PLATINUM, DIAMOND
#
# PREFERENCE CATEGORIES:
#   ROOM, SERVICE, DIETARY, ACCESSIBILITY, COMMUNICATION, BILLING,
#   AMENITY, EXPERIENCE, OTHER
#
# DOCUMENT TYPES:
#   passport, national_id, drivers_license, visa, work_permit,
#   registration_card, invoice, receipt, agreement, contract,
#   photo, signature, credit_card, insurance, other
#
# VERIFICATION STATUSES:
#   pending, verified, rejected, expired, requires_update
#
# COMMUNICATION TYPES:
#   EMAIL, SMS, PHONE, WHATSAPP, IN_PERSON, CHAT
#
# COMMUNICATION DIRECTIONS:
#   INBOUND, OUTBOUND
#
# COMMUNICATION STATUSES:
#   DRAFT, QUEUED, SENT, DELIVERED, FAILED, BOUNCED, OPENED, CLICKED
#
# WRITE OPERATIONS:
#   All guest write operations go through the Command Center.
#   See command-center.http for full examples of:
#     POST /v1/commands/guest.register/execute
#     POST /v1/commands/guest.merge/execute
#     POST /v1/commands/guest.update_profile/execute
#     POST /v1/commands/guest.update_contact/execute
#     POST /v1/commands/guest.set_loyalty/execute
#     POST /v1/commands/guest.set_vip/execute
#     POST /v1/commands/guest.set_blacklist/execute
#     POST /v1/commands/guest.gdpr.erase/execute
#     POST /v1/commands/guest.preference.update/execute
#
# SAMPLE IDs:
#   Tenant:   11111111-1111-1111-1111-111111111111
#   Property: 22222222-2222-2222-2222-222222222222
#   Guest:    33333333-3333-3333-3333-333333333333
#
###############################################################################
